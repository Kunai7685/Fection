if _G.SettingsFection then else return end;if _G.FectionExecuted then warn("You've already executed Fection.")return end _G.FectionExecuted = true
function fromHex(str)return (str:gsub('..', function (cc)return string.char(tonumber(cc, 16))end))end
function PlayBeep(lvl)
	if lvl == "S1" then
		coroutine.resume(coroutine.create(function()
			local Sound = Instance.new("Sound", workspace);
			Sound.SoundId = "http://www.roblox.com/asset/?id=8458408918";
			Sound.Volume = 1;
			Sound.PlaybackSpeed = 1;
			Sound.Looped = false;
			repeat wait() until Sound.IsLoaded == true
			Sound:Play()
			wait(2)
			Sound:Destroy()
		end))
	elseif lvl == "S2" then
		coroutine.resume(coroutine.create(function()
			local Sound = Instance.new("Sound", workspace);
			Sound.SoundId = "http://www.roblox.com/asset/?id=8426701399";
			Sound.Volume = 1;
			Sound.PlaybackSpeed = 1;
			Sound.Looped = false;
			repeat wait() until Sound.IsLoaded == true
			Sound:Play()
			wait(2)
			Sound:Destroy()
		end))
	end
end	
function PlaySound(id, volume, playbackspeed, looped)
	coroutine.resume(coroutine.create(function()
		local Sound = Instance.new("Sound", workspace);
		Sound.SoundId = "http://www.roblox.com/asset/?id="..id;
		Sound.Volume = volume;
		Sound.PlaybackSpeed = playbackspeed;
		Sound.Looped = looped;
		repeat wait() until Sound.IsLoaded == true
		Sound:Play()
		wait(Sound.TimeLength)
		Sound:Destroy()
	end))
end
function AmbushSound()
	coroutine.resume(coroutine.create(function()
		local Sound = Instance.new("Sound", workspace)
		Sound.Name = "AmbushSFXAttention"
		Sound.SoundId = "rbxassetid://11726009506"
		Sound.PlaybackSpeed = 1
		Sound.Volume = 1
		Sound.Looped = false
		repeat wait() until Sound.IsLoaded == true
		local ChorusSoundEffect = Instance.new("ChorusSoundEffect", Sound)
		ChorusSoundEffect.Depth = 0
		ChorusSoundEffect.Enabled = true
		ChorusSoundEffect.Mix = 0.25
		ChorusSoundEffect.Priority = 0
		ChorusSoundEffect.Rate = 2.5
		local EchoSoundEffect = Instance.new("EchoSoundEffect", Sound)
		EchoSoundEffect.Delay = 0.15
		EchoSoundEffect.DryLevel = 1.9
		EchoSoundEffect.Enabled = true
		EchoSoundEffect.Feedback = 0.1
		EchoSoundEffect.Priority = 0
		EchoSoundEffect.WetLevel = -4.4
		Sound:Play()
		wait(Sound.TimeLength + 1.5)
		Sound:Destroy()
	end))
end
game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Fection"; Text = "Running.", Duration = 15, Icon = tostring(fromHex("726278617373657469643a2f2f3131373130393833333033"))})
game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Fection"; Text = "Set your graphics to 1 - Recommended", Duration = 15, Icon = tostring(fromHex("726278617373657469643a2f2f3131373130393833333033"))})
game:GetService("SoundService").AmbientReverb = Enum.ReverbType.Auditorium
local Player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Settings = {
	SprintingSpeed = _G.SettingsFection.SprintingSpeed;
	ProximityPromptMaxActivationDistance = _G.SettingsFection.ProximityPromptMaxActivationDistance;
}
canESP = false
SpEnabled = false
CodeNumsData = {}
ESPData = {}
local function ESPpart(part, primaryColor, secondaryColor)
	if part:IsA("BasePart") then
		if not part:FindFirstChild("FectionESP") then
			local boxEsp = Instance.new("Highlight", part)
			boxEsp.Name = "FectionESP"
			boxEsp.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
			boxEsp.Enabled = true
			boxEsp.FillColor = primaryColor
			boxEsp.FillTransparency = 0.45
			boxEsp.OutlineColor = primaryColor
			coroutine.resume(coroutine.create(function()
				while boxEsp do
					TweenService:Create(boxEsp, TweenInfo.new(0.25, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
						OutlineColor = secondaryColor;
						FillTransparency = 0.25
					}):Play()
					wait(0.25)
					TweenService:Create(boxEsp, TweenInfo.new(0.25, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
						OutlineColor = primaryColor;
						FillTransparency = 0.45
					}):Play()
					wait(0.25)
				end
			end))
		end
	end
end
function espTrigger(part)
	game:GetService("StarterGui"):SetCore("SendNotification", {Title = "B", Text = part.Name, Duration = 5})
	for i,v in pairs(ESPData) do
		print(i.." - "..v.child.Name)
	end
	--if canESP == true then
	--	if v:IsA("BasePart") then
	--	elseif v:IsA("Model") then
	--		if v.Name:lower() == string.lower("FigureRagdoll") then
	--			coroutine.resume(coroutine.create(function()
	--				for ib,vb in pairs(v:GetChildren()) do RunService.RenderStepped:Wait()
	--					if vb:IsA("BasePart") then
	--						ESPpart(vb, Color3.fromRGB(255, 124, 16), Color3.fromRGB(255, 79, 44))
	--					end
	--				end
	--			end))
	--		elseif v.Name:lower() == string.lower("KeyObtain") then
	--			if v:FindFirstChild("Hitbox") then
	--				coroutine.resume(coroutine.create(function()
	--					for ib,vb in pairs(v:FindFirstChild("Hitbox"):GetChildren()) do RunService.RenderStepped:Wait()
	--						if vb:IsA("MeshPart") then
	--							ESPpart(vb, Color3.fromRGB(255, 255, 126), Color3.fromRGB(255, 255, 255))
	--						end
	--					end 
	--				end))
	--			end
	--		elseif v.Name:lower() == string.lower("LeverForGate") then
	--			if v:FindFirstChild("Main") then
	--				ESPpart(v:FindFirstChild("Main"), Color3.fromRGB(255, 255, 255), Color3.fromRGB(155, 155, 155))
	--				ESPpart(v:FindFirstChild("Main"):FindFirstChild("ToUnanchor"), Color3.fromRGB(255, 255, 255), Color3.fromRGB(155, 155, 155))
	--				ESPpart(v:FindFirstChild("Main"):FindFirstChild("ToUnanchor"):FindFirstChild("Handle"), Color3.fromRGB(255, 189, 96), Color3.fromRGB(255, 222, 181))
	--			end
	--		elseif v.Name:lower() == string.lower("LiveHintBook") then
	--			if v:FindFirstChild("Base") then
	--				ESPpart(v:FindFirstChild("Cover1"), v:FindFirstChild("Cover1").Color, v:FindFirstChild("Cover1").Color)
	--				ESPpart(v:FindFirstChild("Cover2"), v:FindFirstChild("Cover2").Color, v:FindFirstChild("Cover2").Color)
	--				ESPpart(v:FindFirstChild("Paper"), v:FindFirstChild("Paper").Color, v:FindFirstChild("Paper").Color)
	--			end
	--		elseif v:IsA("ProximityPrompt") then
	--			v.HoldDuration = 0
	--			v.MaxActivationDistance = Settings.ProximityPromptMaxActivationDistance
	--		end
	--	end
	--end
end
if workspace:FindFirstChild("CurrentRooms") then
	workspace:FindFirstChild("CurrentRooms").DescendantAdded:Connect(espTrigger)
else
	workspace.DescendantAdded:Connect(espTrigger)
end

Player.Chatted:Connect(function(msg)
	if msg == "!playagain" then
		PlayBeep("S1")
		game.ReplicatedStorage.Bricks.PlayAgain:FireServer()
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Fection", Text = ("Playing Again."), Duration = 5})	
	elseif msg == "!lobby" then
		PlayBeep("S1")	
		game.ReplicatedStorage.Bricks.Lobby:FireServer()
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Fection", Text = ("Lobby."), Duration = 5})
	elseif msg == "!revive" then
		PlayBeep("S1")	
		game.ReplicatedStorage.Bricks.Revive:FireServer()
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Fection", Text = ("Revive."), Duration = 5})
	elseif msg == "!rejoin" then
		PlayBeep("S1")		
		local TeleportService = game:GetService("TeleportService")
		TeleportService:Teleport(game.PlaceId, Player)
	elseif msg == "!iy" then
		PlayBeep("S1")
		loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Fection", Text = ("Infinite Yield Executed."), Duration = 5})
	elseif msg == "!beat-up" then
		PlayBeep("S1")
		coroutine.resume(coroutine.create(function()
			PlaySound(9116795681, 1, 1, false)
		end))
	elseif msg:match("!playsound") then
		PlayBeep("S1")
		coroutine.resume(coroutine.create(function()
			local id = string.sub(msg, 11, msg:len())
			print(id)
			PlaySound(id, 1, 1, false)
		end))
	elseif msg == "!betterlighting" then
		PlayBeep("S1")
		coroutine.resume(coroutine.create(function()
			-- Better Lighting By BeemHacks

			local Lighting = game:GetService("Lighting")

			-- Clearing

			game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Better Light v1.0"; Text = "Clearing Lighting"; Duration = 2})

			Lighting:ClearAllChildren()
			Lighting.Ambient = Color3.fromRGB(70, 70, 70)
			Lighting.Brightness = 3
			Lighting.ColorShift_Bottom = Color3.fromRGB(0, 0, 0)
			Lighting.ColorShift_Top = Color3.fromRGB(0, 0, 0)
			Lighting.EnvironmentDiffuseScale = 1
			Lighting.EnvironmentSpecularScale = 1
			Lighting.GlobalShadows = true
			Lighting.OutdoorAmbient = Color3.fromRGB(70, 70, 70)
			Lighting.ShadowSoftness = 0.2
			Lighting.FogColor = Color3.fromRGB(255, 255, 255)
			Lighting.FogEnd = 10000000
			Lighting.FogStart = 15

			wait(0.1)


			-- Replacing

			local Atmostphere = Instance.new("Atmosphere")
			local Sky = Instance.new("Sky")
			local Bloom = Instance.new("BloomEffect")
			local Blur = Instance.new("BlurEffect")
			local ColorCorrection = Instance.new("ColorCorrectionEffect")
			local DepthOfField = Instance.new("DepthOfFieldEffect")
			local SunRays = Instance.new("SunRaysEffect")

			Atmostphere.Parent = Lighting
			Sky.Parent = Lighting
			Bloom.Parent = Lighting
			Blur.Parent = Lighting
			ColorCorrection.Parent = Lighting
			DepthOfField.Parent = Lighting
			SunRays.Parent = Lighting

			Atmostphere.Density = 0.5
			Atmostphere.Offset = 0.15
			Atmostphere.Color = Color3.fromRGB(0, 0, 0)
			Atmostphere.Decay = Color3.fromRGB(50, 50, 50)
			Atmostphere.Glare = 2.5
			Atmostphere.Haze = 5

			Sky.CelestialBodiesShown = true
			Sky.MoonAngularSize = 11
			Sky.MoonTextureId = "rbxassetid://6444320592"
			Sky.SkyboxBk = "rbxassetid://6444884337"
			Sky.SkyboxDn = "rbxassetid://6444884785"
			Sky.SkyboxFt = "rbxassetid://6444884337"
			Sky.SkyboxLf = "rbxassetid://6444884337"
			Sky.SkyboxRt = "rbxassetid://6444884337"
			Sky.SkyboxUp = "rbxassetid://6412503613"
			Sky.StarCount = 3000
			Sky.SunAngularSize = 11
			Sky.SunTextureId = "rbxassetid://6196665106"

			Bloom.Intensity = 0.75
			Bloom.Size = 56
			Bloom.Threshold = 3.446

			Blur.Size = 2.9

			ColorCorrection.Brightness = 0
			ColorCorrection.Contrast = .15
			ColorCorrection.Saturation = -0.15
			ColorCorrection.TintColor = Color3.fromRGB(255, 255 ,255)

			DepthOfField.FarIntensity = 0.54
			DepthOfField.FocusDistance = 14.7
			DepthOfField.InFocusRadius = 12.5
			DepthOfField.NearIntensity = 0.485

			SunRays.Intensity = 0.053
			SunRays.Spread = 0.827

			game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Better Light v1.0"; Text = "All done. Enjoy!"; Duration = 5})
		end))
	end;
end)
UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
	if not gameProcessedEvent then
		if input.KeyCode == Enum.KeyCode.RightShift then
			if SpEnabled == false then
				SpEnabled = true
			else
				SpEnabled = false
			end
		elseif input.KeyCode == Enum.KeyCode.LeftBracket then
			coroutine.resume(coroutine.create(function()
				local last
				for i,v in pairs(workspace.CurrentRooms:GetChildren()) do wait()
					last = v
				end
				local weld = Instance.new("Weld", Player.Character.PrimaryPart)
				weld.Part0 = Player.Character.PrimaryPart
				weld.Part1 = last:FindFirstChild("Door").Door
				weld.Enabled = true
				wait(0.03)
				weld:Destroy()
			end))
		elseif input.KeyCode == Enum.KeyCode.RightBracket then
			if canESP == false then
				canESP = true
				for i,v in pairs(workspace:GetDescendants()) do
					if v:IsA("BasePart") then
					elseif v:IsA("Model") then
						if v.Name:lower() == string.lower("FigureRagdoll") then
							ESPData[i] = {child = v}
							coroutine.resume(coroutine.create(function()
								for ib,vb in pairs(v:GetChildren()) do RunService.RenderStepped:Wait()
									if vb:IsA("BasePart") then
										ESPpart(vb, Color3.fromRGB(255, 124, 16), Color3.fromRGB(255, 79, 44))
									end
								end
							end))
						elseif v.Name:lower() == string.lower("KeyObtain") then
							if v:FindFirstChild("Hitbox") then
								ESPData[i] = {child = v}
								coroutine.resume(coroutine.create(function()
									for ib,vb in pairs(v:FindFirstChild("Hitbox"):GetChildren()) do RunService.RenderStepped:Wait()
										if vb:IsA("MeshPart") then
											ESPpart(vb, Color3.fromRGB(255, 255, 126), Color3.fromRGB(255, 255, 255))
										end
									end 
								end))
							end
						elseif v.Name:lower() == string.lower("LeverForGate") then
							if v:FindFirstChild("Main") then
								ESPData[i] = {child = v}
								ESPpart(v:FindFirstChild("Main"), Color3.fromRGB(255, 255, 255), Color3.fromRGB(155, 155, 155))
								ESPpart(v:FindFirstChild("Main"):FindFirstChild("ToUnanchor"), Color3.fromRGB(255, 255, 255), Color3.fromRGB(155, 155, 155))
								ESPpart(v:FindFirstChild("Main"):FindFirstChild("ToUnanchor"):FindFirstChild("Handle"), Color3.fromRGB(255, 189, 96), Color3.fromRGB(255, 222, 181))
							end
						elseif v.Name:lower() == string.lower("LiveHintBook") then
							if v:FindFirstChild("Base") then
								ESPData[i] = {child = v}
								ESPpart(v:FindFirstChild("Cover1"), v:FindFirstChild("Cover1").Color, v:FindFirstChild("Cover1").Color)
								ESPpart(v:FindFirstChild("Cover2"), v:FindFirstChild("Cover2").Color, v:FindFirstChild("Cover2").Color)
								ESPpart(v:FindFirstChild("Paper"), v:FindFirstChild("Paper").Color, v:FindFirstChild("Paper").Color)
							end
						elseif v:IsA("ProximityPrompt") then
							v.HoldDuration = 0
							v.MaxActivationDistance = Settings.ProximityPromptMaxActivationDistance
						end
					end
				end
			else
				canESP = false
				ESPData = nil
				ESPData = {}
				for i,v in pairs(workspace:GetDescendants()) do
					if v:IsA("Highlight") then
						if v.Name:lower() == string.lower("FectionESP") then
							v:Destroy()
						end
					elseif v:IsA("ProximityPrompt") then
						v.HoldDuration = 0
						v.MaxActivationDistance = Settings.ProximityPromptMaxActivationDistance
					end
				end
			end
		end
	end
end)
RunService.RenderStepped:Connect(function()
	if SpEnabled == true then
		Player.Character.Humanoid.WalkSpeed = Settings.SprintingSpeed
		game:GetService("TweenService"):Create(Player.Character.Humanoid, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
			WalkSpeed = Settings.SprintingSpeed
		}):Play()
	end
	if workspace:FindFirstChild("CurrentRooms") then
		if workspace:FindFirstChild("CurrentRooms"):FindFirstChild("0") then
			workspace:FindFirstChild("CurrentRooms"):FindFirstChild("0").Assets.Desk_Bell.Base.InteractSound.SoundId = "rbxassetid://6832470734"
		end
	end
end)
workspace.Camera.ChildAdded:Connect(function(child)
	if child.Name == "Screech" then
		PlayBeep("S1")
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Warning (Screech)", Text = ("Psst. Screech is watching you!"), Duration = 5})
	end
end)
workspace.ChildAdded:Connect(function(child)
	if child.Name == "RushMoving" then
		PlayBeep("S1")
		if child:WaitForChild("RushNew"):FindFirstChild("BoxHandleAdornment") then
		else
			local boxEsp = Instance.new("BoxHandleAdornment", child:WaitForChild("RushNew"))
			boxEsp.Adornee = child:WaitForChild("RushNew")
			boxEsp.Color3 = Color3.fromRGB(255, 255, 255)
			boxEsp.Transparency = 0.5
			boxEsp.AlwaysOnTop = true
			boxEsp.Size = child:WaitForChild("RushNew").Size
			boxEsp.Visible = true
			boxEsp.ZIndex = 5
			coroutine.resume(coroutine.create(function()
				while boxEsp do
					TweenService:Create(boxEsp, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
						Color3 = Color3.fromRGB(121, 121, 121)
					}):Play()
					wait(1)
					TweenService:Create(boxEsp, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
						Color3 = Color3.fromRGB(255, 255, 255)
					}):Play()
					wait(1)
				end
			end))
		end
		local randomNum = math.random(1,3)
		if randomNum == 2 then
			game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Warning (Rus-)", Text = ("Holy boi, Rus- wait a minute why it sounded different?"), Duration = 5})
			local RushNew = child:WaitForChild("RushNew")
			local PlaySound = RushNew.PlaySound
			RushNew.Footsteps.Playing = false
			PlaySound.SoundId = "rbxassetid://4316136477"
			PlaySound.PlaybackSpeed = 1
			PlaySound.Volume = 1
			RushNew.Attachment.ParticleEmitter.Texture = "rbxassetid://4200490194"
			RushNew.Attachment.BlackTrail.Color = Color3.fromRGB(255,255,255)
			RushNew.Attachment.BlackTrail.Texture = "rbxassetid://4511014399"
		end
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Warning (Rush)", Text = ("Holy Sh*t, Rush is coming."), Duration = 5})
	elseif child.Name == "SeekMoving" then
		PlayBeep("S1")
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Warning (Seek)", Text = ("Man... You gotta run for your life."), Duration = 5})
		if child:WaitForChild("Figure") then
			if child:WaitForChild("Figure"):FindFirstChild("BoxHandleAdornment") then
			else
				local boxEsp = Instance.new("BoxHandleAdornment", child:WaitForChild("Figure"))
				boxEsp.Adornee = child:WaitForChild("Figure")
				boxEsp.Color3 = Color3.fromRGB(255, 0, 4)
				boxEsp.Transparency = 0.5
				boxEsp.AlwaysOnTop = true
				boxEsp.Size = child:WaitForChild("Figure").Size
				boxEsp.Visible = true
				boxEsp.ZIndex = 5
				coroutine.resume(coroutine.create(function()
					while boxEsp do
						TweenService:Create(boxEsp, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
							Color3 = Color3.fromRGB(255, 149, 151)
						}):Play()
						wait(1)
						TweenService:Create(boxEsp, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
							Color3 = Color3.fromRGB(255, 0, 4)
						}):Play()
						wait(1)
					end
				end))
			end
		end
	elseif child.Name == "Lookman" then
		PlayBeep("S1")
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Warning (LookMan)", Text = ("Bro is shy, just like SCP-096"), Duration = 5})
		if child:WaitForChild("Core") then
			if child.RushNew:FindFirstChild("BoxHandleAdornment") then
			else
				local boxEsp = Instance.new("BoxHandleAdornment", child:WaitForChild("Core"))
				boxEsp.Adornee = child:WaitForChild("Core")
				boxEsp.Color3 = Color3.fromRGB(0, 242, 255)
				boxEsp.Transparency = 0.5
				boxEsp.AlwaysOnTop = true
				boxEsp.Size = child:WaitForChild("Core").Size
				boxEsp.Visible = true
				boxEsp.ZIndex = 5
				coroutine.resume(coroutine.create(function()
					while boxEsp do
						TweenService:Create(boxEsp, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
							Color3 = Color3.fromRGB(174, 254, 255)
						}):Play()
						wait(1)
						TweenService:Create(boxEsp, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, false, 0), {
							Color3 = Color3.fromRGB(0, 242, 255)
						}):Play()
						wait(1)
					end
				end))
			end
		end
	elseif child.Name == "AmbushMoving" then
		PlayBeep("S1")
		AmbushSound()
		game:GetService("StarterGui"):SetCore("SendNotification", {Title = "Warning (Ambush)", Text = ("time to spam some Closet"), Duration = 5})
	end
end)

coroutine.resume(coroutine.create(function()
	PlayBeep()
	wait(2)
	PlaySound(6112625298, 1, 1, false)
end))
--[[ ---. .--- ]]--[[ -- -- - -- ------- ------- - - - -- .Success Printer. --]] print("Fection Success.".." 2x") --[[ Hi Fucker, trying to see my Work? ]]
